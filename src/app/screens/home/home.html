<div class="flex flex-col h-full w-full bg-(--bg-100)">

    <app-search-bar (search)="performSearch($event)"></app-search-bar>

    <main class="flex-1 min-h-0 px-3 pb-3
                 sm:px-4 sm:pb-4
                 md:px-6 md:pb-6
                 lg:px-10 lg:pb-8">

        @if(searchService.hasSearched()) {
            <div class="flex justify-start mb-2 pl-1">
                <button (click)="clearSearch()" 
                    class="text-sm sm:text-base text-(--text-300) hover:text-(--text-200) cursor-pointer hover:scale-105">
                    Limpar Resultados
                </button>
            </div>
        }

        <div class="w-full h-full border border-(--bg-300) rounded-sm bg-(--bg-100) p-5">
            <ul>
                @if(!hasSearchResults() && this.searchService.hasSearched()){
                <p class="text-(--text-400)">Resultados não encontrados. Por favor, tente novamente ou digite outro
                    termo.</p>
                } @else {
                @for(item of searchService.searchResults(); track item.pageid){
                <li class="flex flex-col mb-6 last:mb-0">
                    <span>
                        <a [routerLink]="['/article', item.pageid]"
                            class="hover:underline text-[#2316AE] font-semibold text-lg cursor-pointer">{{item.title}}</a>
                    </span>
                    <p class="flex flex-col lg:flex-row justify-between">
                        <span [innerHTML]="item.snippet + ' ...'" ></span>
                        @if(!isFavoritedArticle(item.pageid.toString())){
                        <button class="flex items-top justify-end gap-1 h-10 px-4 font-semibold text-(--text-200) whitespace-nowrap cursor-pointer hover:scale-105"
                            (click)="addFavoriteResult({title: item.title, snippet: item.snippet, pageId: item.pageid.toString()})">
                            <i-lucide [name]="starIcon" color="#cdd016"></i-lucide>
                            <span>Favorite article</span>
                        </button>
                        } @else {
                            <div class="flex items-top gap-1 h-10 px-4 justify-end
                                font-semibold text-(--text-200) whitespace-nowrap
                                sm:h-11 sm:text-md lg:ml-3">
                                <img class="h-6 w-6" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsT
                                    AAALEwEAmpwYAAACu0lEQVR4nO2ZS2sTURTHr28FRUSoC4ViMHPOxLYqRUVcuPEruNKFKPgV+gHEKoiCC4WCILhoaXzW+t50Ydvk3MRdVXBRF924sCAIvmrzl5m0
                                    SYa8JnHuZEbyh7OcM7//OfdO7rlRqquuujImCB9zQsVV0PwCws9VHIUsD0K4AM1ALnlExU3Q9NSFd4MmVZwEbR8qVb8U1mEVF0F4wgvPgPBjFQdBUgerq+8aKDj7Q
                                    kVd0PSwCr5kgh6oKAti74fwcn0DXEDGGlBRFTSn68KXY1xFUcimUg2rX+7CMvLUr6ImCI35qP7qXhhVURIySdtX9Su7oLmvM7AziR7krOMQOgvhSyvr/pNv+HI4z6T
                                    dHE4uJ+dMoicYyDf9O4pnGToF4SEIj0B4GsJf2wBtNX5A07tiYegKNF+Atk9CJxPNwYWGoWkxBMg2gxYdxvoGPu7bBOEnnQflevESs3u2NO7CXGojND2KACw8IfQMU
                                    72b/e2B/OAGCN+P0NKZdFaHL/iSibRaB6G7nYfncaegLcF7TGi+08FlM4qpE+vbgi+ZgFoDoZsdWDa3AbX2n+A9JjTfCK/yPBIYvMeE0PUQDNxy3hUovMeI5osGK3/V
                                    GHjbJ0//G3YsFPiiAb5noAPpMA18MGDgfTjwznlJ01LwBmip5V/btq9NTG3ibPKAeQPaOmPuK0SnQzBAlw0aGDZvwOS8IDxh3oDmeZ9AC8Vx0I0Fn8/Mm4WfS22tee/
                                    p/Zp8cefoismpOCQ5Ruhzkw4UME3bzBnI20cbrN9v7hCeT2xvUoChhpcDOYN/hiBrn68B/ss9PWb6dvnOI7xz5cbhe40OnjNnoPI0KvTbndiy1t62880md7vHdOGfFQ
                                    auBUtd+UKh1yt7II2MnQws71u71+2i5j/Q9CqovNUvcpeKuetxZKwB5x2m8nfV1f+ov0WA2bF0AkOGAAAAAElFTkSuQmCC" alt="filled-star--v1">
                                <span>Favorited article</span>
                            </div>
                            }
                    </p>
                </li>
                }
                }
            </ul>
            
            @if(hasSearchResults()) {
            <div class="flex justify-around items-center mt-4 pt-4 border-t border-(--bg-300)">
                <button 
                    class="px-1 sm:px-4 py-2 bg-(--bg-200) rounded-full disabled:opacity-50 disabled:cursor-not-allowed hover:bg-(--bg-300) cursor-pointer flex items-center gap-1"
                    [disabled]="!hasPrevPage()"
                    (click)="prevPage()">
                    <i-lucide [name]="arrowLeft" class="w-5 h-5"></i-lucide> <span>Anterior</span>
                </button>
                <span class="text-(--text-200) hidden sm:inline text-md">
                    Página {{currentPage()}} de {{totalPages()}}
                </span>
                <span class="text-(--text-200) sm:hidden flex flex-col items-center justify-center">
                    <span>{{currentPage()}} de</span>
                    <span class="text-(--text-200)">{{totalPages()}}</span>
                </span>
                <button 
                    class="px-1 sm:px-4 py-2 bg-(--bg-200) rounded-full disabled:opacity-50 disabled:cursor-not-allowed hover:bg-(--bg-300) cursor-pointer flex items-center gap-1"
                    [disabled]="!hasNextPage()"
                    (click)="nextPage()">
                    <span>Próxima</span> <i-lucide [name]="arrowRight" class="w-5 h-5"></i-lucide>
                </button>
            </div>
            }
        </div>
    </main>
</div>